{"ast":null,"code":"import _regeneratorRuntime from \"C:/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"C:/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _asyncToGenerator from \"C:/Inventory-Clinic-MCC/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport axios from 'axios';\nvar itemsPerPage = 10;\nvar API_URL = 'http://localhost:5000/api/inventory'; // Adjust this to your API URL\n\nexport default {\n  __name: 'Transactions',\n  setup: function setup(__props, _ref) {\n    var __expose = _ref.expose;\n    __expose();\n    var transactions = ref([]);\n    var currentPage = ref(1);\n    var totalItems = ref(0);\n    var filters = ref({\n      transactionType: '',\n      dateRange: '',\n      search: ''\n    });\n    var fetchTransactions = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return axios.get(\"\".concat(API_URL, \"/transactions\"), {\n                params: _objectSpread({\n                  page: currentPage.value,\n                  limit: itemsPerPage\n                }, filters.value)\n              });\n            case 3:\n              response = _context.sent;\n              transactions.value = response.data.data;\n              totalItems.value = response.data.total;\n              _context.next = 11;\n              break;\n            case 8:\n              _context.prev = 8;\n              _context.t0 = _context[\"catch\"](0);\n              console.error('Error fetching transactions:', _context.t0);\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n      return function fetchTransactions() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    onMounted(fetchTransactions);\n    var filteredTransactions = computed(function () {\n      return transactions.value.filter(function (transaction) {\n        var _transaction$Inventor, _transaction$Batch, _transaction$Batch2;\n        var matchesType = !filters.value.transactionType || transaction.transaction_type === filters.value.transactionType;\n        var matchesDate = !filters.value.dateRange || new Date(transaction.date).toDateString() === new Date(filters.value.dateRange).toDateString();\n        var matchesSearch = !filters.value.search || ((_transaction$Inventor = transaction.InventoryItem) === null || _transaction$Inventor === void 0 ? void 0 : _transaction$Inventor.name.toLowerCase().includes(filters.value.search.toLowerCase())) || ((_transaction$Batch = transaction.Batch) === null || _transaction$Batch === void 0 ? void 0 : _transaction$Batch.batch_number) && ((_transaction$Batch2 = transaction.Batch) === null || _transaction$Batch2 === void 0 ? void 0 : _transaction$Batch2.batch_number.toLowerCase().includes(filters.value.search.toLowerCase()));\n        return matchesType && matchesDate && matchesSearch;\n      });\n    });\n    var totalPages = computed(function () {\n      return Math.ceil(totalItems.value / itemsPerPage);\n    });\n    var prevPage = function prevPage() {\n      if (currentPage.value > 1) {\n        currentPage.value--;\n        fetchTransactions();\n      }\n    };\n    var nextPage = function nextPage() {\n      if (currentPage.value < totalPages.value) {\n        currentPage.value++;\n        fetchTransactions();\n      }\n    };\n    var formatDate = function formatDate(dateString) {\n      return new Date(dateString).toLocaleString();\n    };\n    var getTransactionTypeClass = function getTransactionTypeClass(type) {\n      switch (type) {\n        case 'ADD':\n          return 'bg-green-100 text-green-800';\n        case 'REMOVE':\n          return 'bg-red-100 text-red-800';\n        case 'UPDATE':\n          return 'bg-yellow-100 text-yellow-800';\n        case 'DELETE':\n          return 'bg-gray-100 text-gray-800';\n        default:\n          return 'bg-blue-100 text-blue-800';\n      }\n    };\n    var __returned__ = {\n      transactions: transactions,\n      currentPage: currentPage,\n      itemsPerPage: itemsPerPage,\n      totalItems: totalItems,\n      filters: filters,\n      API_URL: API_URL,\n      fetchTransactions: fetchTransactions,\n      filteredTransactions: filteredTransactions,\n      totalPages: totalPages,\n      prevPage: prevPage,\n      nextPage: nextPage,\n      formatDate: formatDate,\n      getTransactionTypeClass: getTransactionTypeClass,\n      ref: ref,\n      computed: computed,\n      onMounted: onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","axios","itemsPerPage","API_URL","transactions","currentPage","totalItems","filters","transactionType","dateRange","search","fetchTransactions","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","concat","params","_objectSpread","page","value","limit","sent","data","total","t0","console","error","stop","apply","arguments","filteredTransactions","filter","transaction","_transaction$Inventor","_transaction$Batch","_transaction$Batch2","matchesType","transaction_type","matchesDate","Date","date","toDateString","matchesSearch","InventoryItem","name","toLowerCase","includes","Batch","batch_number","totalPages","Math","ceil","prevPage","nextPage","formatDate","dateString","toLocaleString","getTransactionTypeClass","type"],"sources":["C:/Inventory-Clinic-MCC/frontend/src/views/Transactions.vue"],"sourcesContent":["<template>\r\n  <div class=\"container mx-auto px-6 py-8\">\r\n    <h1 class=\"text-gray-700 text-3xl font-medium\">Transactions / Audit Log</h1>\r\n    <p class=\"mt-4 text-gray-600\">View and manage all transactions and audit logs related to inventory changes.</p>\r\n    \r\n    <!-- Filters -->\r\n    <div class=\"mt-6 flex flex-wrap gap-4\">\r\n      <div class=\"w-full md:w-64\">\r\n        <label for=\"transactionType\" class=\"block text-sm font-medium text-gray-700\">Transaction Type</label>\r\n        <select\r\n          id=\"transactionType\"\r\n          v-model=\"filters.transactionType\"\r\n          class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"\r\n        >\r\n          <option value=\"\">All Types</option>\r\n          <option value=\"ADD\">Add</option>\r\n          <option value=\"REMOVE\">Remove</option>\r\n          <option value=\"UPDATE\">Update</option>\r\n          <option value=\"DELETE\">Delete</option>\r\n        </select>\r\n      </div>\r\n      <div class=\"w-full md:w-64\">\r\n        <label for=\"dateRange\" class=\"block text-sm font-medium text-gray-700\">Date Range</label>\r\n        <input\r\n          id=\"dateRange\"\r\n          v-model=\"filters.dateRange\"\r\n          type=\"date\"\r\n          class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"\r\n        >\r\n      </div>\r\n      <div class=\"w-full md:w-64\">\r\n        <label for=\"search\" class=\"block text-sm font-medium text-gray-700\">Search</label>\r\n        <input\r\n          id=\"search\"\r\n          v-model=\"filters.search\"\r\n          type=\"text\"\r\n          placeholder=\"Search by item or batch...\"\r\n          class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50\"\r\n        >\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Transactions Table -->\r\n    <div class=\"mt-8 flex flex-col\">\r\n      <div class=\"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8\">\r\n        <div class=\"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8\">\r\n          <div class=\"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg\">\r\n            <table class=\"min-w-full divide-y divide-gray-200\">\r\n              <thead class=\"bg-gray-50\">\r\n                <tr>\r\n                  <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Date</th>\r\n                  <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Type</th>\r\n                  <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Item</th>\r\n                  <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Batch</th>\r\n                  <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Quantity Change</th>\r\n                  <th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Remarks</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody class=\"bg-white divide-y divide-gray-200\">\r\n                <tr v-for=\"transaction in filteredTransactions\" :key=\"transaction.id\">\r\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ formatDate(transaction.date) }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                    <span :class=\"getTransactionTypeClass(transaction.transaction_type)\" class=\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full\">\r\n                      {{ transaction.transaction_type }}\r\n                    </span>\r\n                  </td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ transaction.InventoryItem?.name || 'N/A' }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ transaction.Batch?.batch_number || 'N/A' }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ transaction.quantity_change }}</td>\r\n                  <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ transaction.remarks }}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Pagination -->\r\n    <div class=\"mt-4 flex justify-between items-center\">\r\n      <button\r\n        @click=\"prevPage\"\r\n        :disabled=\"currentPage === 1\"\r\n        class=\"px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\r\n        :class=\"{ 'opacity-50 cursor-not-allowed': currentPage === 1 }\"\r\n      >\r\n        Previous\r\n      </button>\r\n      <span class=\"text-sm text-gray-700\">\r\n        Page {{ currentPage }} of {{ totalPages }}\r\n      </span>\r\n      <button\r\n        @click=\"nextPage\"\r\n        :disabled=\"currentPage === totalPages\"\r\n        class=\"px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50\"\r\n        :class=\"{ 'opacity-50 cursor-not-allowed': currentPage === totalPages }\"\r\n      >\r\n        Next\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport axios from 'axios';\r\n\r\nconst transactions = ref([]);\r\nconst currentPage = ref(1);\r\nconst itemsPerPage = 10;\r\nconst totalItems = ref(0);\r\n\r\nconst filters = ref({\r\n  transactionType: '',\r\n  dateRange: '',\r\n  search: '',\r\n});\r\n\r\nconst API_URL = 'http://localhost:5000/api/inventory'; // Adjust this to your API URL\r\n\r\nconst fetchTransactions = async () => {\r\n  try {\r\n    const response = await axios.get(`${API_URL}/transactions`, {\r\n      params: {\r\n        page: currentPage.value,\r\n        limit: itemsPerPage,\r\n        ...filters.value,\r\n      },\r\n    });\r\n    transactions.value = response.data.data;\r\n    totalItems.value = response.data.total;\r\n  } catch (error) {\r\n    console.error('Error fetching transactions:', error);\r\n  }\r\n};\r\n\r\nonMounted(fetchTransactions);\r\n\r\nconst filteredTransactions = computed(() => {\r\n  return transactions.value.filter(transaction => {\r\n    const matchesType = !filters.value.transactionType || transaction.transaction_type === filters.value.transactionType;\r\n    const matchesDate = !filters.value.dateRange || new Date(transaction.date).toDateString() === new Date(filters.value.dateRange).toDateString();\r\n    const matchesSearch = !filters.value.search || \r\n    transaction.InventoryItem?.name.toLowerCase().includes(filters.value.search.toLowerCase()) ||\r\n      (transaction.Batch?.batch_number &&  transaction.Batch?.batch_number.toLowerCase().includes(filters.value.search.toLowerCase()));\r\n    return matchesType && matchesDate && matchesSearch;\r\n  });\r\n});\r\n\r\nconst totalPages = computed(() => Math.ceil(totalItems.value / itemsPerPage));\r\n\r\nconst prevPage = () => {\r\n  if (currentPage.value > 1) {\r\n    currentPage.value--;\r\n    fetchTransactions();\r\n  }\r\n};\r\n\r\nconst nextPage = () => {\r\n  if (currentPage.value < totalPages.value) {\r\n    currentPage.value++;\r\n    fetchTransactions();\r\n  }\r\n};\r\n\r\nconst formatDate = (dateString) => {\r\n  return new Date(dateString).toLocaleString();\r\n};\r\n\r\nconst getTransactionTypeClass = (type) => {\r\n  switch (type) {\r\n    case 'ADD':\r\n      return 'bg-green-100 text-green-800';\r\n    case 'REMOVE':\r\n      return 'bg-red-100 text-red-800';\r\n    case 'UPDATE':\r\n      return 'bg-yellow-100 text-yellow-800';\r\n    case 'DELETE':\r\n      return 'bg-gray-100 text-gray-800';\r\n    default:\r\n      return 'bg-blue-100 text-blue-800';\r\n  }\r\n};\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}